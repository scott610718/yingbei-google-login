<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•å¼æŒ‡å—ï¼šè·¨è£ç½® QR Code ç™»å…¥æµç¨‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Calm Harmony (Neutral base with blue, green, orange accents) -->
    <!-- Application Structure Plan: A guided, interactive tour structure. Starts with introducing the 3 core components, then walks the user step-by-step through the 7-stage workflow using an interactive diagram. Concludes with explorable key concepts and best practices. This structure turns a static explanation into an engaging learning experience by visualizing the process flow. -->
    <!-- Visualization & Content Choices: The core is an interactive process diagram (HTML/CSS/JS) instead of a chart, as the source material describes a process, not quantitative data. Clicking through steps updates highlighting, text, and animated icons representing data flow (e.g., JWT). This visualizes the relationships and changes over time described in the report. Key terms are in clickable cards (JS toggle) for non-linear learning. This avoids SVG/Mermaid as required. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #f8f9fa;
        }
        .flow-line {
            position: absolute;
            border-style: dashed;
            border-color: #9ca3af; /* gray-400 */
            transition: all 0.5s ease-in-out;
            opacity: 0.5;
        }
        .flow-line.active {
            border-color: #3b82f6; /* blue-500 */
            border-style: solid;
            opacity: 1;
        }
        .data-packet {
            position: absolute;
            padding: 2px 6px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: all 0.5s ease-in-out, transform 0.5s ease-in-out;
            transform: scale(0.5);
            white-space: nowrap;
        }
        .data-packet.visible {
            opacity: 1;
            transform: scale(1);
        }
        .step-content {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        .step-content.hidden-step {
            opacity: 0;
            transform: translateY(10px);
            display: none;
        }
        .component.highlight {
            box-shadow: 0 0 0 3px #3b82f6; /* blue-500 */
            transform: scale(1.03);
        }
        .icon-spin {
            animation: spin 1.5s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-3xl md:text-5xl font-bold text-slate-900">è·¨è£ç½®ç™»å…¥çš„è—è¡“</h1>
            <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">é€™ä»½äº’å‹•æŒ‡å—å°‡å¸¶æ‚¨æ·±å…¥äº†è§£ç¾ä»£ç¶²è·¯æ‡‰ç”¨ä¸­ï¼Œå¾ QR Code æƒæåˆ° Google å¸³è™Ÿå®‰å…¨ç™»å…¥çš„å®Œæ•´æµç¨‹ã€‚</p>
        </header>

        <!-- Section 1: Core Components -->
        <section id="components" class="mb-16">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-8">ä¸‰å¤§æ ¸å¿ƒçµ„ä»¶</h2>
            <div class="grid md:grid-cols-3 gap-8">
                <!-- Desktop Component -->
                <div id="comp-desktop" class="bg-white p-6 rounded-xl shadow-md border border-slate-200 text-center transition-all duration-300">
                    <div class="text-5xl mb-4">ğŸ–¥ï¸</div>
                    <h3 class="text-xl font-semibold mb-2">é›»è…¦ç«¯ (ç™¼èµ·è€…)</h3>
                    <p class="text-slate-600">ç™¼èµ·ç™»å…¥è«‹æ±‚ï¼Œç”Ÿæˆä¸€æ¬¡æ€§çš„æœƒè©± ID (Session ID)ï¼Œä¸¦å°‡å…¶ç·¨ç¢¼ç‚º QR Code ç­‰å¾…æ‰‹æ©Ÿæƒæã€‚</p>
                </div>
                <!-- Mobile Component -->
                <div id="comp-mobile" class="bg-white p-6 rounded-xl shadow-md border border-slate-200 text-center transition-all duration-300">
                    <div class="text-5xl mb-4">ğŸ“±</div>
                    <h3 class="text-xl font-semibold mb-2">æ‰‹æ©Ÿç«¯ (é©—è­‰è€…)</h3>
                    <p class="text-slate-600">æƒæ QR Code ç²å–æœƒè©± IDï¼Œé€é Google å®Œæˆèº«ä»½é©—è­‰ï¼Œä¸¦å°‡æ†‘è­‰å‚³é€å›æŒ‡å®šé€šé“ã€‚</p>
                </div>
                <!-- Firebase Component -->
                <div id="comp-firebase" class="bg-white p-6 rounded-xl shadow-md border border-slate-200 text-center transition-all duration-300">
                    <div class="text-5xl mb-4">â˜ï¸</div>
                    <h3 class="text-xl font-semibold mb-2">é›²ç«¯è³‡æ–™åº« (å®‰å…¨é€šé“)</h3>
                    <p class="text-slate-600">ä½œç‚ºé›»è…¦èˆ‡æ‰‹æ©Ÿé–“å®‰å…¨ã€å³æ™‚çš„è¨Šæ¯æ©‹æ¨‘ï¼Œå‚³éæœƒè©± ID èˆ‡èº«ä»½æ†‘è­‰ (ID Token)ã€‚</p>
                </div>
            </div>
        </section>

        <!-- Section 2: Interactive Workflow -->
        <section id="workflow" class="mb-16">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-8">äº’å‹•å¼å·¥ä½œæµç¨‹</h2>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200">
                
                <!-- Diagram Area -->
                <div class="relative h-[450px] md:h-[300px] mb-8" id="diagram-container">
                    <!-- Nodes -->
                    <div id="diag-desktop" class="absolute top-4 left-4 md:top-1/2 md:-translate-y-1/2 md:left-8 text-center w-24">
                        <div class="text-6xl">ğŸ–¥ï¸</div><p class="font-bold mt-1">é›»è…¦ç«¯</p>
                    </div>
                    <div id="diag-mobile" class="absolute bottom-4 left-1/2 -translate-x-1/2 md:top-1/2 md:-translate-y-1/2 md:left-1/2 md:-translate-x-1/2 text-center w-24">
                        <div class="text-6xl">ğŸ“±</div><p class="font-bold mt-1">æ‰‹æ©Ÿç«¯</p>
                    </div>
                     <div id="diag-google" class="absolute bottom-4 right-4 md:top-8 md:right-1/2 md:translate-x-[150%] text-center w-24">
                        <div class="text-6xl">ğŸ‡¬</div><p class="font-bold mt-1">Google</p>
                    </div>
                    <div id="diag-firebase" class="absolute top-4 right-4 md:top-1/2 md:-translate-y-1/2 md:right-8 text-center w-24">
                        <div class="text-6xl">â˜ï¸</div><p class="font-bold mt-1">Firebase</p>
                    </div>

                    <!-- Flow Lines & Data Packets (Positioned by JS) -->
                </div>

                <!-- Explanation Area -->
                <div id="explanation-area" class="relative min-h-[150px]">
                    <!-- Step Content will be injected here by JS -->
                </div>

                <!-- Navigation -->
                <div class="flex justify-between items-center mt-8">
                    <button id="prevBtn" class="bg-slate-200 text-slate-700 font-bold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">ä¸Šä¸€æ­¥</button>
                    <div class="text-sm text-slate-500"><span id="currentStep">1</span> / 7</div>
                    <button id="nextBtn" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">ä¸‹ä¸€æ­¥</button>
                </div>

            </div>
        </section>

        <!-- Section 3: Key Concepts & Best Practices -->
        <section id="concepts">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-8">é—œéµæ¦‚å¿µèˆ‡æœ€ä½³å¯¦è¸</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Concept cards will be injected here -->
            </div>
        </section>

    </div>

    <footer class="text-center p-8 text-slate-500 text-sm">
        <p>é€™ä»½äº’å‹•æŒ‡å—æ—¨åœ¨å°‡è¤‡é›œçš„æŠ€è¡“æ¦‚å¿µè®Šå¾—ç°¡å–®æ˜“æ‡‚ã€‚</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const steps = [
                {
                    title: "1. å•Ÿå‹•æœƒè©±",
                    description: "é›»è…¦ç«¯ç”Ÿæˆä¸€å€‹å”¯ä¸€çš„ `sessionId`ï¼Œå°‡å…¶æ‰“åŒ…æˆ JSONï¼Œä¸¦å‘ˆç¾åœ¨ QR Code ä¸­ã€‚åŒæ™‚ï¼Œå®ƒé–‹å§‹ç›£è½é›²ç«¯è³‡æ–™åº«ä¸­å°æ‡‰çš„è·¯å¾‘ï¼Œç­‰å¾…æ†‘è­‰ã€‚",
                    highlights: ['desktop', 'firebase'],
                    actions: [
                        { from: 'desktop', to: 'desktop', packet: 'QR Code', type: 'self' }
                    ]
                },
                {
                    title: "2. æƒæèˆ‡é€£çµ",
                    description: "æ‰‹æ©Ÿç«¯æƒæ QR Codeï¼Œè§£æå‡º `sessionId`ã€‚é€™ä¸€åˆ»ï¼Œå…©å€‹è£ç½®é€éé€™å€‹å”¯ä¸€çš„ ID å»ºç«‹äº†é€šè¨Šé€£çµã€‚",
                    highlights: ['mobile'],
                    actions: [
                        { from: 'desktop', to: 'mobile', packet: 'sessionId' }
                    ]
                },
                {
                    title: "3. èº«ä»½é©—è­‰",
                    description: "æ‰‹æ©Ÿç«¯å‘¼å« Google èº«ä»½é©—è­‰æœå‹™ã€‚ç”±æ–¼ä½¿ç”¨è€…åœ¨æ‰‹æ©Ÿä¸Šé€šå¸¸å·²ç™»å…¥ï¼ŒGoogle èƒ½å¤ å¿«é€Ÿç¢ºèªèº«ä»½ï¼Œä¸¦æº–å‚™ç°½ç™¼ä¸€ä»½ ID Tokenã€‚",
                    highlights: ['mobile', 'google'],
                    actions: [
                        { from: 'mobile', to: 'google', packet: 'ç™»å…¥è«‹æ±‚' }
                    ]
                },
                 {
                    title: "4. æ†‘è­‰å‚³è¼¸",
                    description: "Google å°‡ç°½ç™¼çš„ ID Token (JWT) è¿”å›çµ¦æ‰‹æ©Ÿç«¯ã€‚é€™ä»½ Token å°±æ˜¯ä½¿ç”¨è€…çš„æ•¸ä½èº«ä»½è­‰æ˜ã€‚æ¥è‘—ï¼Œæ‰‹æ©Ÿç«¯å°‡æ­¤ Token ä¸Šå‚³è‡³é›²ç«¯è³‡æ–™åº«çš„æŒ‡å®šè·¯å¾‘ã€‚",
                    highlights: ['mobile', 'firebase'],
                    actions: [
                        { from: 'google', to: 'mobile', packet: 'ID Token' },
                        { from: 'mobile', to: 'firebase', packet: 'ID Token' }
                    ]
                },
                {
                    title: "5. æ†‘è­‰æ¥æ”¶èˆ‡é©—è­‰",
                    description: "é›»è…¦ç«¯çš„ç›£è½å™¨è¢«è§¸ç™¼ï¼Œå¾é›²ç«¯è³‡æ–™åº«æ”¶åˆ°äº† ID Tokenã€‚å®ƒè§£æé€™ä»½ Tokenï¼Œå®‰å…¨åœ°æå–å‡ºç”¨æˆ¶è³‡è¨Šï¼Œå¦‚ Email å’Œå§“åã€‚",
                    highlights: ['desktop', 'firebase'],
                    actions: [
                        { from: 'firebase', to: 'desktop', packet: 'ID Token' }
                    ]
                },
                {
                    title: "6. UI æ›´æ–°èˆ‡æœƒè©±è½‰ç§»",
                    description: "é›»è…¦ç«¯ä½¿ç”¨ç²å–çš„ç”¨æˆ¶ Email æ§‹å»ºä¸€å€‹å¸¶æœ‰ç™»å…¥æç¤ºçš„ Google URLã€‚é»æ“ŠæŒ‰éˆ•å¾Œï¼Œæ–°åˆ†é æœƒç›´æ¥æ‰“é–‹å·²ç™»å…¥æˆ–æç¤ºç™»å…¥çš„ Google é é¢ã€‚",
                    highlights: ['desktop'],
                    actions: [
                         { from: 'desktop', to: 'desktop', packet: 'é–‹å•Ÿ Google', type: 'self' }
                    ]
                },
                {
                    title: "7. é€šé“éŠ·æ¯€",
                    description: "é›»è…¦ç«¯æˆåŠŸè™•ç†æ†‘è­‰å¾Œï¼Œæœƒç«‹å³åˆªé™¤é›²ç«¯è³‡æ–™åº«ä¸­çš„æœƒè©±æ•¸æ“šã€‚é€™ç¢ºä¿äº†æ¯å€‹ QR Code åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œæ˜¯é˜²æ­¢é‡æ”¾æ”»æ“Šçš„é—œéµå®‰å…¨æ­¥é©Ÿã€‚",
                    highlights: ['desktop', 'firebase'],
                    actions: [
                        { from: 'desktop', to: 'firebase', packet: 'åˆªé™¤æŒ‡ä»¤' }
                    ]
                }
            ];

            const concepts = [
                { title: "JWT (ID Token)", content: "JSON Web Token æ˜¯ä¸€ç¨®é–‹æ”¾æ¨™æº– (RFC 7519)ï¼Œç”¨æ–¼å®‰å…¨åœ°åœ¨é›™æ–¹ä¹‹é–“å‚³éè³‡è¨Šã€‚å®ƒç¶“éæ•¸ä½ç°½åï¼Œå¯è¢«é©—è­‰å’Œä¿¡ä»»ã€‚Google è¿”å›çš„ ID Token å°±æ˜¯ä¸€ä»½ JWTã€‚" },
                { title: "åŒæºç­–ç•¥", content: "ç€è¦½å™¨çš„ä¸€é …æ ¸å¿ƒå®‰å…¨åŠŸèƒ½ï¼Œç¦æ­¢ä¸€å€‹ä¾†æºçš„è…³æœ¬å»å­˜å–å¦ä¸€å€‹ä¾†æºçš„æ•æ„Ÿæ•¸æ“šï¼ˆå¦‚ Cookieï¼‰ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘ä¸èƒ½ç›´æ¥å¹« google.com ç™»å…¥çš„åŸå› ã€‚" },
                { title: "ç™»å…¥æç¤º (Login Hint)", content: "`?authuser={email}` æ˜¯ Google æä¾›çš„ä¸€ç¨® URL åƒæ•¸ï¼Œç”¨æ–¼å‘Šè¨´ Google é é¢ä½¿ç”¨è€…æ„åœ–ä½¿ç”¨å“ªå€‹å¸³è™Ÿç™»å…¥ï¼Œå¾è€Œç°¡åŒ–æµç¨‹ã€‚" },
                { title: "é‡æ”¾æ”»æ“Š", content: "ä¸€ç¨®ç¶²è·¯æ”»æ“Šå½¢å¼ï¼Œæ”»æ“Šè€…æƒ¡æ„é‡è¤‡æˆ–å»¶é²ä¸€å€‹æœ‰æ•ˆçš„æ•¸æ“šå‚³è¼¸ã€‚æˆ‘å€‘çš„ä¸€æ¬¡æ€§ Session ID å’Œé€šé“éŠ·æ¯€æ©Ÿåˆ¶å¯ä»¥æœ‰æ•ˆé˜²ç¦¦æ­¤é¡æ”»æ“Šã€‚" }
            ];

            let currentStepIndex = 0;

            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const currentStepEl = document.getElementById('currentStep');
            const explanationContainer = document.getElementById('explanation-area');
            const diagramContainer = document.getElementById('diagram-container');
            
            function updateState() {
                currentStepEl.textContent = currentStepIndex + 1;
                prevBtn.disabled = currentStepIndex === 0;
                nextBtn.disabled = currentStepIndex === steps.length - 1;
                
                // Update explanation
                explanationContainer.innerHTML = ''; // Clear previous
                const step = steps[currentStepIndex];
                const newContent = document.createElement('div');
                newContent.className = 'step-content text-center';
                newContent.innerHTML = `
                    <h4 class="text-xl font-bold mb-2 text-blue-600">${step.title}</h4>
                    <p class="text-slate-600 max-w-xl mx-auto">${step.description}</p>
                `;
                explanationContainer.appendChild(newContent);
                
                // Update diagram highlights
                document.querySelectorAll('#components > div, #diagram-container > div').forEach(el => {
                    el.classList.remove('highlight');
                });
                step.highlights.forEach(id => {
                    document.getElementById(`comp-${id}`)?.classList.add('highlight');
                });

                // Update diagram flows
                updateFlows(step.actions);
            }
            
            function getElementCenter(id) {
                const el = document.getElementById(`diag-${id}`);
                const rect = el.getBoundingClientRect();
                const containerRect = diagramContainer.getBoundingClientRect();
                return {
                    x: rect.left - containerRect.left + rect.width / 2,
                    y: rect.top - containerRect.top + rect.height / 2
                };
            }

            function updateFlows(actions = []) {
                diagramContainer.querySelectorAll('.flow-line, .data-packet').forEach(el => el.remove());

                actions.forEach((action, index) => {
                    if (action.type === 'self') {
                        const center = getElementCenter(action.from);
                        const packet = createDataPacket(action.packet);
                        packet.style.left = `${center.x}px`;
                        packet.style.top = `${center.y - 60}px`;
                        diagramContainer.appendChild(packet);
                        setTimeout(() => packet.classList.add('visible'), 100 + index * 200);
                        return;
                    }

                    const from = getElementCenter(action.from);
                    const to = getElementCenter(action.to);
                    
                    const line = document.createElement('div');
                    line.className = 'flow-line';
                    
                    const angle = Math.atan2(to.y - from.y, to.x - from.x) * 180 / Math.PI;
                    const length = Math.sqrt(Math.pow(to.x - from.x, 2) + Math.pow(to.y - from.y, 2));

                    line.style.width = `${length}px`;
                    line.style.left = `${from.x}px`;
                    line.style.top = `${from.y}px`;
                    line.style.transform = `rotate(${angle}deg)`;
                    diagramContainer.appendChild(line);

                    const packet = createDataPacket(action.packet);
                    const midX = (from.x + to.x) / 2 - packet.offsetWidth / 2;
                    const midY = (from.y + to.y) / 2 - packet.offsetHeight / 2;
                    packet.style.left = `${midX}px`;
                    packet.style.top = `${midY}px`;
                    diagramContainer.appendChild(packet);

                    setTimeout(() => {
                        line.classList.add('active');
                        packet.classList.add('visible');
                    }, 100 + index * 200);
                });
            }
            
            function createDataPacket(text) {
                const packet = document.createElement('div');
                const colors = { 'ID Token': 'bg-green-500', 'sessionId': 'bg-orange-500', 'QR Code': 'bg-gray-700' };
                const bgColor = colors[text] || 'bg-blue-500';
                packet.className = `data-packet ${bgColor}`;
                packet.textContent = text;
                return packet;
            }

            function populateConcepts() {
                const container = document.getElementById('concepts').querySelector('div');
                concepts.forEach(concept => {
                    const card = document.createElement('div');
                    card.className = 'bg-white p-6 rounded-xl shadow-md border border-slate-200 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-300';
                    card.innerHTML = `<h4 class="text-xl font-semibold mb-2">${concept.title}</h4><p class="text-slate-600 hidden">${concept.content}</p>`;
                    card.addEventListener('click', () => {
                        card.querySelector('p').classList.toggle('hidden');
                    });
                    container.appendChild(card);
                });
            }

            prevBtn.addEventListener('click', () => {
                if (currentStepIndex > 0) {
                    currentStepIndex--;
                    updateState();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentStepIndex < steps.length - 1) {
                    currentStepIndex++;
                    updateState();
                }
            });

            // Initial setup
            populateConcepts();
            updateState();
            window.addEventListener('resize', () => updateFlows(steps[currentStepIndex].actions));
        });
    </script>
</body>
</html>
